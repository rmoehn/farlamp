% Credits: Pandoc. I extracted most of this from a standalone LaTeX file
% generated by Pandoc.

% tlmgr install xurl marginnote csquotes biblatex lm-math biber
% tlmgr update iftex

\LoadClass[
]{scrartcl}

\RequirePackage{bookmark}
\RequirePackage{xurl}
\RequirePackage{ragged2e}

\RequirePackage{unicode-math}
\defaultfontfeatures{Scale=MatchLowercase}
\defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}

\PassOptionsToPackage{}{xcolor}
\RequirePackage{lmodern}
\RequirePackage{amsmath}
\RequirePackage{tabulary}
\RequirePackage{array}
\RequirePackage{graphicx}
\DeclareGraphicsExtensions{.png}

\RequirePackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
\RequirePackage[dvipsnames,svgnames*,x11names*]{xcolor}

% Not sure if I need this.
% Use upquote if available, for straight quotes in verbatim environments
% \IfFileExists{upquote.sty}{\RequirePackage{upquote}}{}

\hypersetup{
  pdflang={en-GB},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=Blue}

\newcommand*{\addtitledatatopdf}{%
    \makeatletter
    \hypersetup{%
        pdftitle={\@title},
        pdfauthor={\@author},
    }
    \makeatother
}

\urlstyle{same} % disable monospaced font for URLs

%\setlength{\emergencystretch}{3em} % prevent overfull lines

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

% Credits: https://en.wikibooks.org/wiki/LaTeX/Footnotes_and_Margin_Notes#Margin_Notes
\RequirePackage{marginnote}
\newcommand*{\OQsymbol}{\textsc{oq}}
\newcommand*{\OQ}{\marginnote{\OQsymbol}}
\newcommand*{\TODOsymbol}{\textsc{todo}}
\newcommand*{\TODO}{\marginnote{\TODOsymbol}}

% Because ✔ isn't getting printed and it's taking me too long to make it work.
\newcommand*{\done}{\textsc{done}}

% Credits: https://tex.stackexchange.com/a/21229/195421
\RequirePackage{amsthm}
\theoremstyle{definition}
\newtheorem{example}{Example}[section]
\newtheorem{definition}{Definition}[section]

% Credits: https://tex.stackexchange.com/a/44062/195421
\newcommand*{\zkref}[1]{\ignorespaces}

\newcommand*{\task}[1]{#1}
\newcommand*{\Term}[1]{\underline{#1}}
\newcommand*{\Response}{\textit{Response:}}
\newcommand*{\HX}[1]{\ensuremath{\mathit{HX^{#1}}}}
\newcommand*{\X}[1]{\ensuremath{\mathit{X^{#1}}}}
\newcommand*{\Xpa}{\ensuremath{\mathit{X_{\text{\textsc{pa}}}}}}
\newcommand*{\code}[1]{\texttt{#1}}

\DeclareMathOperator{\Amplify}{Amplify}
\newcommand*{\AmpHp}{\ensuremath{\Amplify^{H'}\!\!(\Xpa)}}

\newcommand*{\Overfail}{\href{https://github.com/rmoehn/farlamp/blob/master/overfail2.pdf}{Overseer
failures in SupAmp and ReAmp}}
\newcommand*{\Obs}{\paragraph{Observation}}
\newcommand*{\Disc}{\paragraph{Discussion}}

\newcommand*{\blx@nowarnpolyglossia}{\relax}

% Load polyglossia as late as possible: uses bidi with RTL langages (e.g. Hebrew, Arabic)
\RequirePackage{polyglossia}
\setmainlanguage[variant=british]{english}
\RequirePackage[english=british]{csquotes}

\MakeAutoQuote{‘}{’}
\MakeAutoQuote*{“}{”}

\RequirePackage[
    style=authoryear-comp,
    maxcitenames=1,
    seconds=true,
    date=year,
    urldate=iso
]{biblatex}

% Credits: https://tex.stackexchange.com/a/126245/195421
\makeatletter
\DeclareCiteCommand{\fullcite}
  {\defcounter{maxnames}{\blx@maxbibnames}%
    \usebibmacro{prenote}}
  {\usedriver
     {\DeclareNameAlias{sortname}{default}}
     {\thefield{entrytype}}}
  {\multicitedelim}
  {\usebibmacro{postnote}}
\makeatother

\newcommand*{\annotitem}[1]{\addtocategory{annotated}{#1}\paragraph{\fullcite{#1}}}
